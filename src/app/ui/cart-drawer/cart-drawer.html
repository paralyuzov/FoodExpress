<p-drawer header="Your Purchase" [visible]="visible()" (onHide)="onHide()" position="right"
  styleClass="w-[450px]! bg-slate-900! text-amber-300! font-serif!">
  <div class="flex flex-col h-full font-pt-sans">
    <div class="border-b border-slate-700 pb-4 mb-4">
      <p class="text-sm text-slate-400">Review your items before checkout</p>
    </div>

    <div class="flex-1 space-y-4">
      @if (isCartEmpty()) {
      <div class="text-center py-12">
        <i class="pi pi-shopping-cart text-4xl text-slate-500 mb-4"></i>
        <h4 class="text-lg font-medium text-slate-300 mb-2">Your cart is empty</h4>
        <p class="text-sm text-slate-400">Add some delicious items to get started!</p>
      </div>
      } @else { @for(cartItem of cartItems(); track cartItem.dish.id) {
      <div class="flex items-center justify-between p-4 bg-slate-200 rounded-lg shadow-lg shadow-slate-400">
        <div class="flex items-center space-x-2">
          <img src="{{ cartItem.dish.imageUrl }}" alt="Dish Image" class="w-24 h-24 object-cover rounded-lg" />
          <div class="space-y-1 text-center">
            <h5 class="font-semibold text-black">{{ cartItem.dish.name }}</h5>
            <p class="font-mono text-amber-800">${{ cartItem.dish.price | number : '1.2-2' }}</p>
          </div>
        </div>
        <div class="flex items-center justify-between">
          <p-inputnumber [ngModel]="cartItem.quantity" (ngModelChange)="updateQuantity(cartItem.dish.id, $event)"
            [min]="1" [max]="99" [showButtons]="true" buttonLayout="vertical" size="small"
            [inputStyle]="{ width: '3rem', textAlign: 'center' }" class="cart-quantity-input">
            <ng-template #incrementbuttonicon>
              <span class="pi pi-plus"></span>
            </ng-template>
            <ng-template #decrementbuttonicon>
              <span class="pi pi-minus"></span>
            </ng-template>
          </p-inputnumber>

          <button (click)="removeItem(cartItem.dish.id)"
            class="ml-2 w-8 h-8 flex items-center justify-center bg-red-600 hover:bg-red-700 text-white rounded transition-colors"
            title="Remove item">
            <i class="pi pi-trash text-xs"></i>
          </button>
        </div>
      </div>
      } }
    </div>


    @if(!isCartEmpty()) {
      <div class="border-t border-slate-700 pt-4 mt-4 font-pt-sans">
      <div class="flex flex-col justify-between items-center mb-4 text-md ">


        <div class="self-end flex space-x-2 text-md">
          <span class=" font-semibold text-amber-200">Subtotal:</span>
          <span class=" font-bold text-amber-200">${{ cartSubTotal() | number : '1.2-2' }}</span>
        </div>



        <div class="self-end flex space-x-2 text-md">
          <span class=" font-semibold text-amber-200">Tax(5%):</span>
          <span class="  font-bold text-amber-200">${{ cartTax() | number : '1.2-2' }}</span>
        </div>


        <div class="self-end flex space-x-2 text-md">
          <span class=" font-semibold text-amber-200">Delivery Fee:</span>
          <span class=" font-bold text-amber-200">${{ cartDeliveryFee() | number : '1.2-2' }}</span>
        </div>

        <div class="self-end flex space-x-2 text-lg">
          <span class=" font-semibold text-amber-300">Total:</span>
          <span class=" font-bold text-green-400">${{ cartTotal() | number : '1.2-2' }}</span>
        </div>

      </div>

      <button [disabled]="isCartEmpty()"
        class="w-full bg-gradient-to-r from-amber-400 to-amber-500 hover:from-amber-500 hover:to-amber-600 disabled:from-gray-600 disabled:to-gray-700 disabled:cursor-not-allowed text-slate-900 disabled:text-slate-400 font-semibold py-3 px-4 rounded-lg transition-all duration-200">
        Proceed to Checkout
      </button>
    </div>
    }

  </div>
</p-drawer>
